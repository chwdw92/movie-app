{"ast":null,"code":"var _jsxFileName = \"/Users/david/Desktop/interview-project/movie-app/src/components/pages/Search.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { TextField, InputAdornment } from '@mui/material';\nimport SearchIcon from '@mui/icons-material/Search';\nimport { trendingBaseUrl, searchBaseUrl } from '../../helpers/constants';\nimport PreviewContent from '../commons/PreviewContent';\nimport CustomPagination from '../commons/layouts/CustomPagination';\nimport { scrollToTop } from '../../helpers/functions';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Search(_ref) {\n  _s();\n\n  let {\n    passoverPropObj\n  } = _ref;\n  const {\n    pageTitle,\n    searchInputPlaceholder,\n    mediaType,\n    mediaTypeText,\n    extraQueryStrForTrendingReq,\n    extraQueryStrForSearchReq,\n    extraQueryStrForDetailReq,\n    loading,\n    setLoading\n  } = passoverPropObj;\n  const [page, setPage] = useState(1);\n  const [searchText, setSearchText] = useState('');\n  const [content, setContent] = useState([]);\n  const [numOfPages, setNumOfPages] = useState();\n  const [timeoutId, setTimeoutId] = useState(null);\n  const trendingUrlWtPage = trendingBaseUrl.replace('%mediaType%', mediaType) + extraQueryStrForTrendingReq;\n  const searchUrlWtPageWtSearchText = searchBaseUrl.replace('%mediaType%', mediaType) + extraQueryStrForSearchReq;\n  useEffect(() => {\n    if (searchText.length === 0) {\n      // console.log('1');\n      // trending page request\n      fetchTrendingContent();\n    } else {\n      // console.log('2');\n      fetchDataForSearch();\n    }\n  }, [page]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const fetchTrendingContent = async () => {\n    setLoading(true);\n    const trendingUrl = trendingUrlWtPage + `&page=${page}`;\n    const {\n      data\n    } = await axios.get(trendingUrl);\n    setContent(data.results);\n    setNumOfPages(data.total_pages);\n    setLoading(false);\n    scrollToTop();\n  };\n\n  const searchChanges = e => {\n    const currentSearch = e.target.value.trim();\n    const tempPrevSearch = searchText.trim();\n    setSearchText(currentSearch);\n    const minLenToTiggerApiCall = 1;\n    const timeIntervalForApiCall = 400; // ms \n    // canceling the previous reserved API call. \n\n    clearTimeout(timeoutId);\n    setTimeoutId(null); // reset \n    // check if there is any changes in the search text\n\n    if (currentSearch !== tempPrevSearch) {\n      if (currentSearch.length > minLenToTiggerApiCall) {\n        // search request\n        // for debouncing\n        setTimeoutId(setTimeout(() => {\n          // reset to page 1\n          fetchDataForSearch();\n          setPage(1); // use useEffect to a trigger search API call\n        }, timeIntervalForApiCall));\n      } else if (currentSearch.length === 0) {\n        // empty search text -> reset to first trending page.\n        setPage(1); // use useEffect to a trigger a fetching trending API call\n      }\n    }\n  };\n\n  const fetchDataForSearch = async function () {\n    let paramPage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    let paramSearchText = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    setLoading(true);\n    const page = paramPage ? paramPage : page;\n    const searchText = paramSearchText ? paramSearchText : searchText;\n    const searchUrl = searchUrlWtPageWtSearchText + `&page=${page}&query=${searchText}`;\n    const {\n      data\n    } = await axios.get(searchUrl);\n    setContent(data.results);\n    setNumOfPages(data.total_pages);\n    setLoading(false);\n    scrollToTop();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: pageTitle\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(TextField, {\n      className: \"mui-text-field\",\n      required: true,\n      label: searchInputPlaceholder,\n      variant: \"standard\",\n      InputProps: {\n        startAdornment: /*#__PURE__*/_jsxDEV(InputAdornment, {\n          position: \"start\",\n          children: /*#__PURE__*/_jsxDEV(SearchIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 13\n        }, this)\n      },\n      defaultValue: searchText,\n      onChange: e => searchChanges(e)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }, this), loading ? '' : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [content && content.map(previewInfo => {\n        const passoverPropObj = {\n          id: previewInfo.id,\n          poster: previewInfo.poster_path,\n          title: previewInfo.title || previewInfo.name,\n          date: previewInfo.release_date || previewInfo.first_air_date,\n          mediaType: mediaType,\n          mediaTypeText: mediaTypeText,\n          voteAvg: previewInfo.vote_average,\n          extraQueryStrForDetailReq,\n          setLoading\n        };\n        return /*#__PURE__*/_jsxDEV(PreviewContent, {\n          passoverPropObj: passoverPropObj\n        }, previewInfo.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 26\n        }, this);\n      }), !content && '0 results found', numOfPages > 1 && /*#__PURE__*/_jsxDEV(CustomPagination, {\n        setPage: setPage,\n        numOfPages: numOfPages\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 30\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 12\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Search, \"v+tTDHQz0e/0yYfKD1FeDS2PM3Y=\");\n\n_c = Search;\nexport default Search;\n\nvar _c;\n\n$RefreshReg$(_c, \"Search\");","map":{"version":3,"sources":["/Users/david/Desktop/interview-project/movie-app/src/components/pages/Search.js"],"names":["useState","useEffect","axios","TextField","InputAdornment","SearchIcon","trendingBaseUrl","searchBaseUrl","PreviewContent","CustomPagination","scrollToTop","Search","passoverPropObj","pageTitle","searchInputPlaceholder","mediaType","mediaTypeText","extraQueryStrForTrendingReq","extraQueryStrForSearchReq","extraQueryStrForDetailReq","loading","setLoading","page","setPage","searchText","setSearchText","content","setContent","numOfPages","setNumOfPages","timeoutId","setTimeoutId","trendingUrlWtPage","replace","searchUrlWtPageWtSearchText","length","fetchTrendingContent","fetchDataForSearch","trendingUrl","data","get","results","total_pages","searchChanges","e","currentSearch","target","value","trim","tempPrevSearch","minLenToTiggerApiCall","timeIntervalForApiCall","clearTimeout","setTimeout","paramPage","paramSearchText","searchUrl","startAdornment","map","previewInfo","id","poster","poster_path","title","name","date","release_date","first_air_date","voteAvg","vote_average"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { TextField, InputAdornment } from '@mui/material';\nimport SearchIcon from '@mui/icons-material/Search';\nimport { trendingBaseUrl, searchBaseUrl } from '../../helpers/constants';\nimport PreviewContent from '../commons/PreviewContent';\nimport CustomPagination from '../commons/layouts/CustomPagination';\nimport { scrollToTop } from '../../helpers/functions'; \n\n\n\n\nfunction Search({ passoverPropObj }) {\n    const { pageTitle, searchInputPlaceholder, mediaType, mediaTypeText, extraQueryStrForTrendingReq, extraQueryStrForSearchReq, extraQueryStrForDetailReq, loading,\n      setLoading } = passoverPropObj;\n    \n    const [page, setPage] = useState(1);\n    const [searchText, setSearchText] = useState('');\n    const [content, setContent] = useState([]);\n    const [numOfPages, setNumOfPages] = useState();\n    const [timeoutId, setTimeoutId] = useState(null); \n\n    const trendingUrlWtPage = trendingBaseUrl.replace('%mediaType%', mediaType)+extraQueryStrForTrendingReq;\n    const searchUrlWtPageWtSearchText = searchBaseUrl.replace('%mediaType%', mediaType)+extraQueryStrForSearchReq;\n    \n    \n    useEffect(() => {\n      if(searchText.length === 0) {\n        // console.log('1');\n          // trending page request\n        fetchTrendingContent();\n      }else {\n        // console.log('2');\n        fetchDataForSearch();\n      }\n      \n    }, [page]); // eslint-disable-line react-hooks/exhaustive-deps\n\n    const fetchTrendingContent = async() => {\n      setLoading(true);\n      const trendingUrl = trendingUrlWtPage+`&page=${page}`;\n      const { data } = await axios.get(trendingUrl);\n\n      setContent(data.results);\n      setNumOfPages(data.total_pages);\n      setLoading(false);\n      scrollToTop();\n    };\n\n\n  const searchChanges = (e) => {\n  \n    const currentSearch = e.target.value.trim(); \n    const tempPrevSearch = searchText.trim();\n\n    \n    setSearchText(currentSearch);\n\n    const minLenToTiggerApiCall = 1; \n    const timeIntervalForApiCall = 400; // ms \n\n    // canceling the previous reserved API call. \n    clearTimeout(timeoutId);\n    setTimeoutId(null); // reset \n    \n    // check if there is any changes in the search text\n    if( currentSearch !== tempPrevSearch ) {\n        if(currentSearch.length > minLenToTiggerApiCall) {\n          // search request\n          // for debouncing\n          setTimeoutId(setTimeout(()=> { \n            // reset to page 1\n            fetchDataForSearch();\n            setPage(1);  // use useEffect to a trigger search API call\n          }, timeIntervalForApiCall));\n        }else if(currentSearch.length === 0) {\n            // empty search text -> reset to first trending page.\n            setPage(1); // use useEffect to a trigger a fetching trending API call\n        }\n    }\n  }\n\n\n  const fetchDataForSearch =  async (paramPage = null, paramSearchText = null) => {\n    setLoading(true);\n    const page = paramPage? paramPage : page;\n    const searchText = paramSearchText? paramSearchText : searchText;\n    const searchUrl = searchUrlWtPageWtSearchText+`&page=${page}&query=${searchText}`;\n    const { data } = await axios.get(searchUrl);\n\n    setContent(data.results);\n    setNumOfPages(data.total_pages);\n  \n    setLoading(false);\n    scrollToTop();\n  }\n\n  \n    return (\n        <section>\n            <h2>{pageTitle}</h2> \n            <TextField className='mui-text-field' required label={searchInputPlaceholder} variant=\"standard\"  InputProps={{\n          startAdornment: (\n            <InputAdornment position=\"start\">\n              <SearchIcon />\n            </InputAdornment>\n          ),\n        }}  defaultValue={searchText} onChange={(e)=>searchChanges(e)} />        \n\n      { (loading)? '' :   \n          (<div>\n          {\n              content && content.map((previewInfo) => {\n                   const passoverPropObj = {\n                    id: previewInfo.id,\n                    poster: previewInfo.poster_path, \n                    title: previewInfo.title || previewInfo.name,\n                    date: previewInfo.release_date || previewInfo.first_air_date,\n                    mediaType:mediaType,\n                    mediaTypeText:mediaTypeText,\n                    voteAvg:previewInfo.vote_average,\n                    extraQueryStrForDetailReq,\n                    setLoading\n                   };\n                  return <PreviewContent key={previewInfo.id} passoverPropObj={passoverPropObj} />;\n              })\n          }\n\n          {\n            !content && '0 results found'\n          }\n          {numOfPages > 1 && <CustomPagination setPage={setPage} numOfPages={numOfPages} />}\n        </div>)\n      }\n        </section>\n    )\n}\n\nexport default Search\n\n"]},"metadata":{},"sourceType":"module"}