{"ast":null,"code":"var _jsxFileName = \"/Users/david/Desktop/interview-project/movie-app/src/components/pages/Search.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { TextField, InputAdornment } from '@mui/material';\nimport SearchIcon from '@mui/icons-material/Search';\nimport { trendingBaseUrl, searchBaseUrl } from '../../helpers/constants';\nimport PreviewContent from '../commons/PreviewContent';\nimport CustomPagination from '../commons/layouts/CustomPagination';\nimport { scrollToTop } from '../../helpers/functions';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Search(_ref) {\n  _s();\n\n  let {\n    passoverPropObj\n  } = _ref;\n  const {\n    pageTitle,\n    searchInputPlaceholder,\n    mediaType,\n    mediaTypeText,\n    extraQueryStrForTrendingReq,\n    extraQueryStrForSearchReq,\n    extraQueryStrForDetailReq,\n    loading,\n    setLoading\n  } = passoverPropObj;\n  const [page, setPage] = useState(1);\n  const [searchText, setSearchText] = useState('');\n  const [content, setContent] = useState([]);\n  const [numOfPages, setNumOfPages] = useState();\n  const [timeoutId, setTimeoutId] = useState(null);\n  var apiCallManuallyTriggeredFlag = false;\n  const trendingUrlWtPage = trendingBaseUrl.replace('%mediaType%', mediaType) + extraQueryStrForTrendingReq;\n  const searchUrlWtPageWtSearchText = searchBaseUrl.replace('%mediaType%', mediaType) + extraQueryStrForSearchReq; // useEffect(() => {\n  //   if(!apiCallManuallyTriggeredFlag) {\n  //     if(searchText.length === 0) {\n  //         // trending page request\n  //       fetchTrendingContent();\n  //     }else {\n  //       fetchDataForSearch();\n  //     }\n  //   }\n  // }, [page]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const fetchTrendingContent = async function () {\n    let paramPage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    console.log('trending');\n    setLoading(true);\n    const reqPage = paramPage ? paramPage : page;\n    const trendingUrl = trendingUrlWtPage + `&page=${reqPage}`;\n    const {\n      data\n    } = await axios.get(trendingUrl);\n    setContent(data.results);\n    setNumOfPages(data.total_pages);\n    setLoading(false);\n    scrollToTop();\n  };\n\n  const searchChanges = e => {\n    const currentSearch = e.target.value.trim();\n    const tempPrevSearch = searchText.trim();\n    setSearchText(currentSearch);\n    const minLenToTiggerApiCall = 1;\n    const timeIntervalForApiCall = 400; // ms \n    // canceling the previous reserved API call. \n\n    clearTimeout(timeoutId);\n    setTimeoutId(null); // reset \n    // check if there is any changes in the search text\n\n    if (currentSearch !== tempPrevSearch) {\n      if (currentSearch.length > minLenToTiggerApiCall) {\n        // search request\n        // for debouncing\n        setTimeoutId(setTimeout(() => {\n          apiCallManuallyTriggeredFlag = true; // prevent a useEffect api call \n\n          setPage(1); // reset to page 1\n\n          fetchDataForSearch(1, currentSearch);\n        }, timeIntervalForApiCall));\n      } else if (currentSearch.length === 0) {\n        apiCallManuallyTriggeredFlag = true; // prevent a useEffect api call \n        // empty search text -> reset to first trending page.\n\n        setPage(1); // reset to page 1\n\n        fetchTrendingContent(1);\n      }\n    }\n  };\n\n  const fetchDataForSearch = async function () {\n    let paramPage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    let paramSearchText = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    console.log('search');\n    setLoading(true);\n    const reqPage = paramPage ? paramPage : page;\n    const reqSearchText = paramSearchText ? paramSearchText : searchText;\n    const searchUrl = searchUrlWtPageWtSearchText + `&page=${reqPage}&query=${reqSearchText}`;\n    const {\n      data\n    } = await axios.get(searchUrl);\n    setContent(data.results);\n    setNumOfPages(data.total_pages);\n    setLoading(false);\n    scrollToTop();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: pageTitle\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(TextField, {\n      className: \"mui-text-field\",\n      required: true,\n      label: searchInputPlaceholder,\n      variant: \"standard\",\n      InputProps: {\n        startAdornment: /*#__PURE__*/_jsxDEV(InputAdornment, {\n          position: \"start\",\n          children: /*#__PURE__*/_jsxDEV(SearchIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 13\n        }, this)\n      },\n      defaultValue: searchText,\n      onChange: e => searchChanges(e)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }, this), loading ? '' : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [content && content.map(previewInfo => {\n        const passoverPropObj = {\n          id: previewInfo.id,\n          poster: previewInfo.poster_path,\n          title: previewInfo.title || previewInfo.name,\n          date: previewInfo.release_date || previewInfo.first_air_date,\n          mediaType: mediaType,\n          mediaTypeText: mediaTypeText,\n          voteAvg: previewInfo.vote_average,\n          extraQueryStrForDetailReq,\n          setLoading\n        };\n        return /*#__PURE__*/_jsxDEV(PreviewContent, {\n          passoverPropObj: passoverPropObj\n        }, previewInfo.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 26\n        }, this);\n      }), content.length === 0 && '0 results found', numOfPages > 1 && /*#__PURE__*/_jsxDEV(CustomPagination, {\n        currPage: page,\n        setPage: setPage,\n        numOfPages: numOfPages\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 30\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 12\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Search, \"CVPQ+0ahksXVL/smTTQsDtDFkSE=\");\n\n_c = Search;\nexport default Search;\n\nvar _c;\n\n$RefreshReg$(_c, \"Search\");","map":{"version":3,"sources":["/Users/david/Desktop/interview-project/movie-app/src/components/pages/Search.js"],"names":["useState","useEffect","axios","TextField","InputAdornment","SearchIcon","trendingBaseUrl","searchBaseUrl","PreviewContent","CustomPagination","scrollToTop","Search","passoverPropObj","pageTitle","searchInputPlaceholder","mediaType","mediaTypeText","extraQueryStrForTrendingReq","extraQueryStrForSearchReq","extraQueryStrForDetailReq","loading","setLoading","page","setPage","searchText","setSearchText","content","setContent","numOfPages","setNumOfPages","timeoutId","setTimeoutId","apiCallManuallyTriggeredFlag","trendingUrlWtPage","replace","searchUrlWtPageWtSearchText","fetchTrendingContent","paramPage","console","log","reqPage","trendingUrl","data","get","results","total_pages","searchChanges","e","currentSearch","target","value","trim","tempPrevSearch","minLenToTiggerApiCall","timeIntervalForApiCall","clearTimeout","length","setTimeout","fetchDataForSearch","paramSearchText","reqSearchText","searchUrl","startAdornment","map","previewInfo","id","poster","poster_path","title","name","date","release_date","first_air_date","voteAvg","vote_average"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { TextField, InputAdornment } from '@mui/material';\nimport SearchIcon from '@mui/icons-material/Search';\nimport { trendingBaseUrl, searchBaseUrl } from '../../helpers/constants';\nimport PreviewContent from '../commons/PreviewContent';\nimport CustomPagination from '../commons/layouts/CustomPagination';\nimport { scrollToTop } from '../../helpers/functions'; \n\n\n\n\nfunction Search({ passoverPropObj }) {\n    const { pageTitle, searchInputPlaceholder, mediaType, mediaTypeText, extraQueryStrForTrendingReq, extraQueryStrForSearchReq, extraQueryStrForDetailReq, loading,\n      setLoading } = passoverPropObj;\n    \n    const [page, setPage] = useState(1);\n    const [searchText, setSearchText] = useState('');\n    const [content, setContent] = useState([]);\n    const [numOfPages, setNumOfPages] = useState();\n    const [timeoutId, setTimeoutId] = useState(null); \n    var apiCallManuallyTriggeredFlag = false; \n\n    const trendingUrlWtPage = trendingBaseUrl.replace('%mediaType%', mediaType)+extraQueryStrForTrendingReq;\n    const searchUrlWtPageWtSearchText = searchBaseUrl.replace('%mediaType%', mediaType)+extraQueryStrForSearchReq;\n    \n    \n    // useEffect(() => {\n    //   if(!apiCallManuallyTriggeredFlag) {\n    //     if(searchText.length === 0) {\n    //         // trending page request\n    //       fetchTrendingContent();\n    //     }else {\n    //       fetchDataForSearch();\n    //     }\n    //   }\n      \n    // }, [page]); // eslint-disable-line react-hooks/exhaustive-deps\n\n    const fetchTrendingContent = async(paramPage = null) => {\n      console.log('trending');\n      setLoading(true);\n      const reqPage = paramPage? paramPage : page;\n      const trendingUrl = trendingUrlWtPage+`&page=${reqPage}`;\n      const { data } = await axios.get(trendingUrl);\n\n      setContent(data.results);\n      setNumOfPages(data.total_pages);\n      setLoading(false);\n      scrollToTop();\n    };\n\n\n  const searchChanges = (e) => {\n  \n    const currentSearch = e.target.value.trim(); \n    const tempPrevSearch = searchText.trim();\n\n    \n    setSearchText(currentSearch);\n\n    const minLenToTiggerApiCall = 1; \n    const timeIntervalForApiCall = 400; // ms \n\n    // canceling the previous reserved API call. \n    clearTimeout(timeoutId);\n    setTimeoutId(null); // reset \n    \n    // check if there is any changes in the search text\n    if( currentSearch !== tempPrevSearch ) {\n        if(currentSearch.length > minLenToTiggerApiCall) {\n          // search request\n          // for debouncing\n          setTimeoutId(setTimeout(()=> { \n            apiCallManuallyTriggeredFlag = true; // prevent a useEffect api call \n            setPage(1);  // reset to page 1\n            fetchDataForSearch(1, currentSearch);\n          }, timeIntervalForApiCall));\n        }else if(currentSearch.length === 0) {\n            apiCallManuallyTriggeredFlag = true; // prevent a useEffect api call \n            // empty search text -> reset to first trending page.\n            setPage(1);  // reset to page 1\n            fetchTrendingContent(1);\n        }\n    }\n  }\n\n\n  const fetchDataForSearch =  async (paramPage = null, paramSearchText = null) => {\n    console.log('search');\n    setLoading(true);\n    const reqPage = paramPage? paramPage : page;\n    const reqSearchText = paramSearchText? paramSearchText : searchText;\n    const searchUrl = searchUrlWtPageWtSearchText+`&page=${reqPage}&query=${reqSearchText}`;\n    const { data } = await axios.get(searchUrl);\n\n    setContent(data.results);\n    setNumOfPages(data.total_pages);\n  \n    setLoading(false);\n    scrollToTop();\n  }\n\n  \n    return (\n        <section>\n            <h2>{pageTitle}</h2> \n            <TextField className='mui-text-field' required label={searchInputPlaceholder} variant=\"standard\"  InputProps={{\n          startAdornment: (\n            <InputAdornment position=\"start\">\n              <SearchIcon />\n            </InputAdornment>\n          ),\n        }}  defaultValue={searchText} onChange={(e)=>searchChanges(e)} />        \n\n      { (loading)? '' :   \n          (<div>\n          {\n              content && content.map((previewInfo) => {\n                   const passoverPropObj = {\n                    id: previewInfo.id,\n                    poster: previewInfo.poster_path, \n                    title: previewInfo.title || previewInfo.name,\n                    date: previewInfo.release_date || previewInfo.first_air_date,\n                    mediaType:mediaType,\n                    mediaTypeText:mediaTypeText,\n                    voteAvg:previewInfo.vote_average,\n                    extraQueryStrForDetailReq,\n                    setLoading\n                   };\n                  return <PreviewContent key={previewInfo.id} passoverPropObj={passoverPropObj} />;\n              })\n          }\n\n          {\n            (content.length === 0) && '0 results found'\n          }\n          {numOfPages > 1 && <CustomPagination currPage={page} setPage={setPage} numOfPages={numOfPages} />}\n        </div>)\n      }\n        </section>\n    )\n}\n\nexport default Search\n\n"]},"metadata":{},"sourceType":"module"}